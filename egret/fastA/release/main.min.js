var LoadingUI=function(t){function e(){t.call(this),this.createView()}__extends(e,t);var a=(__define,e),r=a.prototype;return r.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},r.setProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);egret.registerClass(LoadingUI,"LoadingUI");var Main=function(t){function e(){t.call(this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(e,t);var a=(__define,e),r=a.prototype;return r.onAddToStage=function(t){var e=new PerformanceATest;this.addChild(e)},e}(egret.DisplayObjectContainer);egret.registerClass(Main,"Main");var BaseTest=function(t){function e(){t.call(this),this._resourceConfigURL="resource/default.res.json",this._loadingView=null,this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(e,t);var a=(__define,e),r=a.prototype;return r.onAddToStage=function(t){this._resourceConfigURL?(this._loadingView=new LoadingUI,this.stage.addChild(this._loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig(this._resourceConfigURL,"resource/")):this.init()},r.onResourceLoadError=function(t){console.warn("Group: "+t.groupName+" has failed to load."),this.onResourceLoadComplete(t)},r.onResourceProgress=function(t){"preload"==t.groupName&&this._loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},r.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.loadGroup("preload")},r.onResourceLoadComplete=function(t){"preload"==t.groupName&&(this.stage.removeChild(this._loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),this.init())},r.init=function(){egret.Ticker.getInstance().register(this.onAdvanceTime,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouch,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouch,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onTouch,this)},r.onAdvanceTime=function(t){dragonBones.WorldClock.clock.advanceTime(.001*t)},r.onTouch=function(t){},e}(egret.Sprite);egret.registerClass(BaseTest,"BaseTest");var PerformanceATest=function(t){function e(){t.call(this),this._dragonBonesData=null,this._factory=new dragonBones.EgretFactory,this._armatures=[],this._text=new egret.TextField,this._addArmature=!1,this._removeArmature=!1,this._resourceConfigURL="resource/PerformanceTestAConfig.json"}__extends(e,t);var a=(__define,e),r=a.prototype;return r.init=function(){t.prototype.init.call(this),this.stage.dirtyRegionPolicy="off",this._text.x=0,this._text.wordWrap=!1,this._text.textColor=16711680,this._text.textAlign=egret.HorizontalAlign.CENTER,this._text.width=this.stage.stageWidth,this._text.y=this.stage.stageHeight-80,this.addChild(this._text),this._dragonBonesData=dragonBones.DataParser.parseDragonBonesData(RES.getRes("dragonBonesData"));var e=RES.getRes("textureDataA"),a=RES.getRes("textureA");this._factory.addDragonBonesData(this._dragonBonesData),this._factory.addTextureAtlas(new dragonBones.EgretTextureAtlas(a,e));for(var r=0;90>r;++r)this.addArmature();this.resetPosition()},r.onAdvanceTime=function(e){t.prototype.onAdvanceTime.call(this,e),this._addArmature&&(this.addArmature(),this.addArmature(),this.addArmature(),this.addArmature(),this.addArmature(),this.resetPosition()),this._removeArmature&&(this.removeArmature(),this.removeArmature(),this.removeArmature(),this.removeArmature(),this.removeArmature(),this.resetPosition())},r.onTouch=function(t){switch(t.type){case egret.TouchEvent.TOUCH_BEGIN:this._addArmature=t.stageX>.5*this.stage.stageWidth,this._removeArmature=t.stageX<.5*this.stage.stageWidth;break;case egret.TouchEvent.TOUCH_END:case egret.TouchEvent.TOUCH_CANCEL:this._addArmature=!1,this._removeArmature=!1}},r.resetPosition=function(){for(var t=this._armatures.length,e=50,a=150,r=5,s=(this.stage.stageWidth-2*e)/r,i=(this.stage.stageHeight-2*a)/Math.ceil(t/r),o=0,n=this._armatures.length;n>o;++o){var h=this._armatures[o],d=h.display,u=Math.floor(o/r);d.x=o%r*s+e,d.y=u*i+a}},r.addArmature=function(){var t=this._factory.buildFastArmature(this._dragonBonesData.armatureDataList[0].name),e=t.display;e.scaleX=e.scaleY=.8,t.enableAnimationCache(24),t.animation.gotoAndPlay(t.animation.animationList[1],0,0,0),dragonBones.WorldClock.clock.add(t),this.addChild(e),this._armatures.push(t),this.updateText()},r.removeArmature=function(){if(0!=this._armatures.length){var t=this._armatures.pop(),e=t.display;dragonBones.WorldClock.clock.remove(t),this.removeChild(e),this.updateText()}},r.updateText=function(){this._text.text="数量: "+this._armatures.length+" \n点击屏幕 左侧减少/右侧增加 数量"},e}(BaseTest);egret.registerClass(PerformanceATest,"PerformanceATest");var PerformanceBTest=function(t){function e(){t.call(this),this._dragonBonesData=null,this._factory=new dragonBones.EgretFactory,this._armatures=[],this._text=new egret.TextField,this._addArmature=!1,this._removeArmature=!1,this._resourceConfigURL="resource/PerformanceTestBConfig.json"}__extends(e,t);var a=(__define,e),r=a.prototype;return r.init=function(){t.prototype.init.call(this),this.stage.dirtyRegionPolicy="off",this._text.x=0,this._text.wordWrap=!1,this._text.textColor=16711680,this._text.textAlign=egret.HorizontalAlign.CENTER,this._text.width=this.stage.stageWidth,this._text.y=this.stage.stageHeight-80,this.addChild(this._text),this._dragonBonesData=dragonBones.DataParser.parseDragonBonesData(RES.getRes("dragonBonesData"));var e=RES.getRes("textureDataA"),a=RES.getRes("textureA");this._factory.addDragonBonesData(this._dragonBonesData),this._factory.addTextureAtlas(new dragonBones.EgretTextureAtlas(a,e));for(var r=0;400>r;++r)this.addArmature();this.resetPosition()},r.onAdvanceTime=function(e){t.prototype.onAdvanceTime.call(this,e),this._addArmature&&(this.addArmature(),this.addArmature(),this.addArmature(),this.addArmature(),this.addArmature(),this.resetPosition()),this._removeArmature&&(this.removeArmature(),this.removeArmature(),this.removeArmature(),this.removeArmature(),this.removeArmature(),this.resetPosition())},r.onTouch=function(t){switch(t.type){case egret.TouchEvent.TOUCH_BEGIN:this._addArmature=t.stageX>.5*this.stage.stageWidth,this._removeArmature=t.stageX<.5*this.stage.stageWidth;break;case egret.TouchEvent.TOUCH_END:case egret.TouchEvent.TOUCH_CANCEL:this._addArmature=!1,this._removeArmature=!1}},r.resetPosition=function(){for(var t=this._armatures.length,e=50,a=100,r=5,s=(this.stage.stageWidth-2*e)/r,i=(this.stage.stageHeight-2*a)/Math.ceil(t/r),o=0,n=this._armatures.length;n>o;++o){var h=this._armatures[o],d=h.display,u=Math.floor(o/r);d.x=o%r*s+e,d.y=u*i+a}},r.addArmature=function(){var t=this._factory.buildFastArmature(this._dragonBonesData.armatureDataList[0].name),e=t.display;e.scaleX=e.scaleY=.7,t.animation.timeScale=.7,t.enableAnimationCache(24),t.animation.gotoAndPlay(t.animation.animationList[0],0,0,0),dragonBones.WorldClock.clock.add(t),this.addChild(e),this._armatures.push(t),this.updateText()},r.removeArmature=function(){if(0!=this._armatures.length){var t=this._armatures.pop(),e=t.display;dragonBones.WorldClock.clock.remove(t),this.removeChild(e),this.updateText()}},r.updateText=function(){this._text.text="数量: "+this._armatures.length+" \n点击屏幕 右侧增加 / 左侧减少"},e}(BaseTest);egret.registerClass(PerformanceBTest,"PerformanceBTest");var SingleTest=function(t){function e(){t.call(this),this._dragonBonesData=null,this._factory=new dragonBones.EgretFactory,this._armature=null,this._animationIndex=0,this._resourceConfigURL="resource/SingleTestConfig.json"}__extends(e,t);var a=(__define,e),r=a.prototype;return r.init=function(){t.prototype.init.call(this),this._dragonBonesData=dragonBones.DataParser.parseDragonBonesData(RES.getRes("dragonBonesData"));var e=RES.getRes("textureDataA"),a=RES.getRes("textureA");this._factory.addSkeletonData(this._dragonBonesData),this._factory.addTextureAtlas(new dragonBones.EgretTextureAtlas(a,e)),this._armature=this._factory.buildArmature(this._dragonBonesData.armatureDataList[0].name);var r=this._armature.display;r.x=240,r.y=600,r.scaleX=1,r.scaleY=1,this.addChild(r),this._armature.animation.gotoAndPlay(this._armature.animation.animationList[0]),dragonBones.WorldClock.clock.add(this._armature)},r.onTouch=function(t){this._animationIndex++,this._animationIndex>=this._armature.animation.animationList.length&&(this._animationIndex=0);var e=this._armature.animation.animationList[this._animationIndex];this._armature.animation.gotoAndPlay(e)},e}(BaseTest);egret.registerClass(SingleTest,"SingleTest");